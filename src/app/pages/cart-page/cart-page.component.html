<div class="cart-container">
    <div class="page-header">
        <h1>Gi·ªè h√†ng c·ªßa b·∫°n</h1>
    </div>

    <div class="cart-content" *ngIf="(items$ | async)?.length; else emptyState">
        <div class="cart-table">
            <div class="table-header">
                <div class="col-product">S·∫£n ph·∫©m</div>
                <div class="col-price">ƒê∆°n gi√°</div>
                <div class="col-quantity">S·ªë l∆∞·ª£ng</div>
                <div class="col-total">Th√†nh ti·ªÅn</div>
                <div class="col-action"></div>
            </div>

            <div class="table-row" *ngFor="let item of (items$ | async)">
                <div class="col-product">
                    <div class="product-info">
                        <div class="product-name">{{ item.name }}</div>
                    </div>
                </div>
                <div class="col-price">{{ item.price | number }}ƒë</div>
                <div class="col-quantity">
                    <div class="qty-control">
                        <button (click)="updateQty(item.productId, item.quantity - 1)"
                            [disabled]="item.quantity <= 1">-</button>
                        <input type="number" [value]="item.quantity"
                            (change)="updateQty(item.productId, $any($event.target).value)" min="1" max="99">
                        <button (click)="updateQty(item.productId, item.quantity + 1)"
                            [disabled]="item.quantity >= 99">+</button>
                    </div>
                </div>
                <div class="col-total">{{ (item.price * item.quantity) | number }}ƒë</div>
                <div class="col-action">
                    <button class="remove-btn" (click)="removeItem(item.productId)">
                        <i nz-icon nzType="delete"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="cart-summary">
            <div class="summary-box">
                <h3>T·ªïng ƒë∆°n h√†ng</h3>
                <div class="summary-row total">
                    <span>T·ªïng c·ªông:</span>
                    <span class="total-price">{{ total$ | async | number }}ƒë</span>
                </div>
                <button nz-button nzType="primary" nzBlock nzSize="large" (click)="checkout()">
                    Thanh to√°n ngay
                </button>
            </div>
        </div>
    </div>

    <ng-template #emptyState>
        <div class="empty-cart-page">
            <div class="icon-wrapper">üõí</div>
            <h2>Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng</h2>
            <p>H√£y ch·ªçn th√™m s·∫£n ph·∫©m ƒë·ªÉ mua s·∫Øm nh√©</p>
            <a routerLink="/" nz-button nzType="primary">Ti·∫øp t·ª•c mua s·∫Øm</a>
        </div>
    </ng-template>
</div>